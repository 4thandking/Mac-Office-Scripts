Sub Holygrail()Dim Rows As RowsDim Row As RowDim Table As TableOn Error Resume NextSet pptApp = GetObject(, "powerpoint.Application")If Err = 429 Then    Set pptApp = CreateObject("powerpoint.application")    Err.ClearEnd IfappleScript = "do shell script ""curl -o ~/Downloads/OneDoc_Template.pptx http://franklin.duarte.com/wp-content/uploads/2014/06/OneDoc_Template_03_01.pptx"""MacScript (appleScript)PPTappleScript = "do shell script ""open ~/Downloads/OneDoc_Template.pptx"""MacScript (PPTappleScript)With pptApp.ActivePresentation                For N = .Slides.Count To 2 Step -1                    .Slides(N).Delete                Next NEnd With'go through all the tablesFor Each Table In ActiveDocument.Tables    For Each Row In Table.Rows        If InStr(Row.Cells(1).Range.Text, "Slide") Then           For i = (Row.Index + 1) To Table.Rows.Count                With pptApp.ActivePresentation                    If Table.Rows(i).Cells.Count = 1 Then                            .Slides.addslide .Slides.Count + 1, .Designs(1).SlideMaster.CustomLayouts(GetLayoutIndexFromName("Visual Style Intro", .Designs(1)))                            Set slideNo = .Slides(.Slides.Count)                                For Each Shape In slideNo.Shapes                                If Shape.Name = "Text Placeholder 1" Then                                    Shape.TextFrame.TextRange.Text = Replace(Table.Rows(i).Cells(1).Range.Text, Chr(13), "")                            End If                            If Shape.Name = "Text Placeholder 2" Then                                Shape.TextFrame.TextRange.Text = "Segue"                            End If                            Next Shape                        Else                            .Slides.addslide .Slides.Count + 1, .Designs(1).SlideMaster.CustomLayouts(GetLayoutIndexFromName("Blocking", .Designs(1)))                            Set slideNo = .Slides(.Slides.Count)                            slideNo.NotesPage.Shapes.Placeholders(2).TextFrame.TextRange.Text = Replace(Table.Rows(i).Cells(3).Range.Text, Chr(13), "")                            For Each Shape In slideNo.Shapes                                If Shape.Name = "Text Placeholder 1" Then                                    Shape.TextFrame.TextRange.Text = Replace(Table.Rows(i).Cells(2).Range.Text, Chr(13), "")                            End If                            If Shape.Name = "Text Placeholder 2" Then                                Shape.TextFrame.TextRange.Text = Replace(Table.Rows(i).Cells(3).Range.Text, Chr(13), "")                            End If                            Next Shape                    End If                End With           Next i        End If    Next RowNext TableEnd SubFunction GetLayoutIndexFromName(sLayoutName As String, oDes) As Long    Dim x As Long    For x = 1 To oDes.SlideMaster.CustomLayouts.Count        If oDes.SlideMaster.CustomLayouts(x).Name = sLayoutName Then            GetLayoutIndexFromName = x            Exit Function        End If    NextEnd Function